---
- name: Enable kv secrets engine
  terryhowe.hashivault.hashivault_secret_engine:
    authtype: token
    url: "{{ vault_url }}"
    token: "{{ vault_token }}"
    name: kv
    backend: kv

- name: Enable approle auth module
  terryhowe.hashivault.hashivault_auth_method:
    authtype: token
    url: "{{ vault_url }}"
    token: "{{ vault_token }}"
    method_type: approle

- name: Create read policy
  terryhowe.hashivault.hashivault_policy:
    authtype: token
    url: "{{ vault_url }}"
    token: "{{ vault_token }}"
    name: read
    rules: "{{ vault_rules_read }}"

- name: Create write policy
  terryhowe.hashivault.hashivault_policy:
    authtype: token
    url: "{{ vault_url }}"
    token: "{{ vault_token }}"
    name: write
    rules: "{{ vault_rules_write }}"
